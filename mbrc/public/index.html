<!DOCTYPE html>
<html>
<head>
    <title>Remote Control</title>
    <style>
        #keypad_table {
            width: 100%;
            border-collapse: collapse;
            text-align: center;
            table-layout: fixed;
        }
        #keypad_table,
        #keypad_table td,
        #keypad_table tr {
            border: 2px solid black;
        }
        #keypad_table td {
            width: 25%;
        }
        .key {
            background-color:#99ccff;
            font-size: 50px;
        }
	.num {
	    background-color:#cce6ff;	
	}
        .focused {
            background-color:#3366ff;
        }
        html, body {
            /*To take in the window header*/
            height: 95%; 
        }
        .stretch {
            height: 100%;
        }
        #prev_div {
            height: 70px;
            margin: 10px;
        }
        #prev {
            padding: 0px 0px 5px 20px;
            margin: 0px;
            font-size: 65px;
        }
    </style>
</head>

<body>

    <noscript>
        Your browser does not support javascript.
    </noscript>

    <script>
        var focused
	var saved_classes //when a button loses focus, it gets its old classes
        var prev
        window.onload = function() {
            console.log("DERP")
            var keys = document.getElementsByClassName("key")
            for (var i=0; i<keys.length; i++) {
                keys[i].onclick = clickHandler
            }
            prev = document.getElementById("prev")
            prev.innerText = ""
        }

        function clickHandler(e) {
            if (focused != null) {
                focused.className = saved_classes
            }
            focused = e.target
	    saved_classes = focused.className
            focused.className = "key focused"
            var txt = focused.innerText
            //alert(txt)

            //send data
            var xhttp = new XMLHttpRequest();
            var url = "/command?key="+txt
            xhttp.onreadystatechange = function() {
                if (this.readyState == 4 && this.status == 200) {
                   //document.getElementById("demo").innerHTML = xhttp.responseText;
                    //update preview
                    if (!isNaN(txt)) {
                        prev.innerText += focused.innerText
                    } else if (txt == "Enter") {
                        prev.innerText = "" 
                    }
                }
            }
            xhttp.open("GET", url, true);
            xhttp.send();
        }
    </script>

    <div id="prev_div">
        <p id="prev"></p>
    </div>
    <div class="stretch">
        <table class="stretch" id="keypad_table">
            <tr>
                <td class="key">On</td>
                <td class="key">Off</td>
                <td colspan=2 style="width:50%" class="key">&uarr;</td>
            </tr>
            <tr>
                <td class="key num">1</td>
                <td class="key num">2</td>
                <td class="key num">3</td>
                <td class="key">&darr;</td>
            </tr>
            <tr>
                <td class="key num">4</td>
                <td class="key num">5</td>
                <td class="key num">6</td>
                <td class="key">Sleep</td>
            </tr>
                <td class="key num">7</td>
                <td class="key num">8</td>
                <td class="key num">9</td>
                <td class="key">&larr;</td>
            </tr>
            <tr>
                <td class="key">Delete</td>
                <td class="key num">0</td>
                <td class="key">Enter</td>
                <td class="key">&rarr;</td>
            </tr>
        </table>
    </div>

</body>

</html>
